<div fxLayout="column" class="mat-typography">
  <div fxLayout="row" fxLayoutAlign="space-between center">
    <h1 class="mat-headline">Submission</h1>
    <mat-chip-list selectable="false">
      <mat-basic-chip [ngClass]="getSubmissionStateChipClassName(submissionState)">{{submissionState}}</mat-basic-chip>
    </mat-chip-list>
  </div>
  <div>
  <h3 class="subheading-2">{{projectName}}</h3>
    <mat-tab-group [selectedIndex]="!submissionEnvelopeId && !submissionEnvelopeUuid ? 1 : 0">
      <mat-tab label="Overview" [disabled]="!submissionEnvelopeId">
        <ng-template matTabContent>
        <project-view [project]="project">
        </project-view>
        <ng-container *ngIf="isLinkingDone">
          <button mat-raised-button color="basic" (click)="downloadFile()"><span>Download spreadsheet</span></button>
        </ng-container>
        <ng-container *ngFor="let error of project?.validationErrors">
          <span class="text-danger" title="{{error.userFriendlyMessage}}">* {{error.userFriendlyMessage}}</span><br>
        </ng-container>
        <br/>
        <span><strong>Ingest Link</strong></span>
        <span><p><a href="{{submissionEnvelope?._links?.self?.href}}"><span class="oi oi-external-link"></span></a></p></span>
        <br/>
        </ng-template>
      </mat-tab>
      <mat-tab label="Metadata">
        <ng-template matTabContent>
          <app-upload *ngIf="!submissionEnvelopeId && !submissionEnvelopeUuid" [projectUuid]="projectUuid"></app-upload>
          <app-metadata *ngIf="submissionEnvelopeId"
            [projectUuid]="projectUuid"
            [submissionEnvelopeId]="submissionEnvelopeId"
            [manifest]="manifest">
          </app-metadata>
        </ng-template>
      </mat-tab>
      <mat-tab label="Data" [disabled]="!submissionEnvelopeId">
        <ng-template matTabContent>
        <app-files
                [submissionEnvelope]="submissionEnvelope"
                [submissionEnvelopeId]="submissionEnvelopeId"
                [manifest]="manifest">
        </app-files>
        </ng-template>
      </mat-tab>
      <mat-tab label="Submit" [disabled]="!isValid" >
        <ng-template matTabContent>
        <app-submit
                [submissionEnvelope$]="submissionEnvelope$"
                [submitLink]="submitLink"
                [isSubmitted]="isSubmitted"
                [submissionUrl]="url"
                [submissionEnvelopeId]="submissionEnvelopeId"
                [isLinkingDone]="isLinkingDone"
                [manifest]="manifest">
        </app-submit>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
  </div>
  <div fxLayout="row" fxLayoutAlign="end">
    <button *ngIf="submissionEnvelope && submissionEnvelope.open" mat-icon-button (click)="onDeleteSubmission(submissionEnvelope)">
      <mat-icon>delete_forever</mat-icon>
    </button>
  </div>
</div>
