<form *ngIf="done" class="vf-form" [formGroup]="metadataForm.formGroup" (submit)="onSubmit($event)">

  <mat-tab-group>

    <ng-container *ngFor="let tab of config.layout['tabs']">
      <mat-tab [label]="tab['title']">
        <div class="vf-u-margin__top--xxl">
          <ng-container *ngFor="let item of tab['items']">
            <ng-container *ngIf="metadataForm.get(item).isObject() || metadataForm.get(item).isScalarList() || metadataForm.get(item).isScalar()">
              <ng-container appMetadataField [metadata]="metadataForm.get(item)"
                            [control]="metadataForm.formGroup['controls'][metadataForm.get(item).key]">

              </ng-container>
            </ng-container>

            <ng-container *ngIf="metadataForm.get(item).isObjectList()">
              <ng-container
                *ngFor="let control of metadataForm.formGroup['controls'][metadataForm.get(item).key]['controls'] ; let i = index">
                <ng-container *ngFor="let child of metadataForm.get(item).childrenMetadata">
                  <ng-container appMetadataField [metadata]="child"
                                [control]="control['controls'][child.key]">
                  </ng-container>
                </ng-container>

                <ng-container *ngIf="!config.viewMode">
                  <a color="warn" mat-icon-button
                     (click)="removeFormControl(metadataForm.formGroup['controls'][metadataForm.get(item).key], i)">
                    <mat-icon>remove_circle_outline</mat-icon>
                    Remove
                  </a>
                </ng-container>

                <hr class="vf-divider">

              </ng-container>

              <ng-container *ngIf="!config.viewMode">
                <a mat-icon-button
                   (click)="addFormControl(metadataForm.get(item), metadataForm.formGroup['controls'][metadataForm.get(item).key])">
                  <mat-icon>add_circle_outline</mat-icon>
                  Add
                </a>
              </ng-container>
            </ng-container>

          </ng-container>
        </div>
      </mat-tab>
    </ng-container>
  </mat-tab-group>

  <ng-container *ngIf="!config.viewMode">
    <a (click)="confirmCancel($event)" class="vf-button vf-button--tertiary vf-button--sm">Cancel</a>
    <button class="vf-button vf-button--primary vf-button--sm">Save and Continue</button>
  </ng-container>
</form>
