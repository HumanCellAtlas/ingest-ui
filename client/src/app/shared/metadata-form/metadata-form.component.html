<form [formGroup]="formConfig['project']['formControl']" (ngSubmit)="onSubmit()">
  <mat-tab-group>
    <mat-tab label="Project">
      <div class="vf-u-margin__top--xxl">


        <div [formGroup]="formConfig['project.project_core']['formControl']">
          <ng-container
            *ngFor="let child of formConfig['project.project_core']['children']">

            <app-vf-input *ngIf="formConfig[child]['field']['schema']['type'] === 'string'"
                          [formControlName]="formConfig[child]['field']['key']"
                          [label]="formConfig[child]['field']['schema']['user_friendly']?formConfig[child]['field']['schema']['user_friendly'] : formConfig[child]['field']['key']"
                          [type]="'text'"
                          [example]="formConfig[child]['field']['schema']['example']"
                          [helperText]="formConfig[child]['field']['schema']['guidelines']"
                          [isRequired]="formConfig[child]['field']['isRequired']">

            </app-vf-input>
          </ng-container>
        </div>

        <ng-container
          *ngFor="let child of formConfig['project']['children']">

          <app-vf-input *ngIf="formConfig[child]['field']['schema']['type'] === 'string'"
                        [formControlName]="formConfig[child]['field']['key']"
                        [label]="formConfig[child]['field']['schema']['user_friendly']?formConfig[child]['field']['schema']['user_friendly'] : formConfig[child]['field']['key']"
                        [type]="'text'"
                        [example]="formConfig[child]['field']['schema']['example']"
                        [helperText]="formConfig[child]['field']['schema']['guidelines']"
                        [isRequired]="formConfig[child]['field']['isRequired']">

          </app-vf-input>

        </ng-container>


        <div formArrayName="array_express_accessions">
          <ng-container
            *ngFor="let control of formConfig['project.array_express_accessions']['formControl']['controls'] ; let i = index">
            <app-vf-input [formControl]="control"
                          [label]="formConfig['project.array_express_accessions']['field']['schema']['user_friendly']?formConfig['project.array_express_accessions']['field']['schema']['user_friendly'] : formConfig['project.array_express_accessions']['field']['key']"
                          [type]="'text'"
                          [example]="formConfig['project.array_express_accessions']['field']['schema']['example']"
                          [helperText]="formConfig['project.array_express_accessions']['field']['schema']['guidelines']"
                          [isRequired]="formConfig['project.array_express_accessions']['field']['isRequired']">

            </app-vf-input>

          </ng-container>
        </div>

        <div formArrayName="insdc_study_accessions">
          <ng-container
            *ngFor="let control of formConfig['project.insdc_study_accessions']['formControl']['controls'] ; let i = index">
            <app-vf-input [formControl]="control"
                          [label]="formConfig['project.insdc_study_accessions']['field']['schema']['user_friendly']?formConfig['project.insdc_study_accessions']['field']['schema']['user_friendly'] : formConfig['project.insdc_study_accessions']['field']['key']"
                          [type]="'text'"
                          [example]="formConfig['project.insdc_study_accessions']['field']['schema']['example']"
                          [helperText]="formConfig['project.insdc_study_accessions']['field']['schema']['guidelines']"
                          [isRequired]="formConfig['project.insdc_study_accessions']['field']['isRequired']">

            </app-vf-input>
          </ng-container>
        </div>
      </div>
    </mat-tab>


    <mat-tab label="Contributors">
      <div class="vf-u-margin__top--xxl">
        <div formArrayName="contributors">
          <ng-container
            *ngFor="let contributorFormGroup of formConfig['project.contributors']['formControl']['controls'] ; let i = index">
            <div [formGroup]="contributorFormGroup">
              <ng-container
                *ngFor="let child of formConfig['project.contributors']['children']">

                <app-vf-input *ngIf="formConfig[child]['field']['schema']['type'] === 'string'"
                              [formControlName]="formConfig[child]['field']['key']"
                              [label]="formConfig[child]['field']['schema']['user_friendly']?formConfig[child]['field']['schema']['user_friendly'] : formConfig[child]['field']['key']"
                              [type]="'text'"
                              [example]="formConfig[child]['field']['schema']['example']"
                              [helperText]="formConfig[child]['field']['schema']['guidelines']"
                              [isRequired]="formConfig[child]['field']['isRequired']">

                </app-vf-input>
              </ng-container>
            </div>
          </ng-container>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="Publications">
      <div class="vf-u-margin__top--xxl">
        <div formArrayName="publications">
          <ng-container
            *ngFor="let publicationFormGroup of formConfig['project.publications']['formControl']['controls'] ; let i = index">
            <div [formGroup]="publicationFormGroup">
              <ng-container
                *ngFor="let child of formConfig['project.publications']['children']">

                <app-vf-input *ngIf="formConfig[child]['field']['schema']['type'] === 'string'"
                              [formControlName]="formConfig[child]['field']['key']"
                              [label]="formConfig[child]['field']['schema']['user_friendly']?formConfig[child]['field']['schema']['user_friendly'] : formConfig[child]['field']['key']"
                              [type]="'text'"
                              [example]="formConfig[child]['field']['schema']['example']"
                              [helperText]="formConfig[child]['field']['schema']['guidelines']"
                              [isRequired]="formConfig[child]['field']['isRequired']">

                </app-vf-input>
              </ng-container>
            </div>
          </ng-container>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="Funders">
      <div class="vf-u-margin__top--xxl">
        <div formArrayName="funders">
          <ng-container
            *ngFor="let funderFormGroup of formConfig['project.funders']['formControl']['controls'] ; let i = index">
            <div [formGroup]="funderFormGroup">
              <ng-container *ngFor="let child of formConfig['project.funders']['children']">
                <app-vf-input *ngIf="formConfig[child]['field']['schema']['type'] === 'string'"
                              [formControlName]="formConfig[child]['field']['key']"
                              [label]="formConfig[child]['field']['schema']['user_friendly']?formConfig[child]['field']['schema']['user_friendly'] : formConfig[child]['field']['key']"
                              [type]="'text'"
                              [example]="formConfig[child]['field']['schema']['example']"
                              [helperText]="formConfig[child]['field']['schema']['guidelines']"
                              [isRequired]="formConfig[child]['field']['isRequired']">
                </app-vf-input>
              </ng-container>
            </div>
          </ng-container>
        </div>
      </div>
    </mat-tab>

  </mat-tab-group>


  <a class="vf-button vf-button--tertiary vf-button--sm" routerLink="/projects">Cancel</a>
  <button type="submit" class="vf-button vf-button--primary vf-button--sm">Save and Continue</button>

</form>
